<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">
    <h:head>
        <title>Registro Ruta</title>
    </h:head>
    <h:body>
        <ui:composition template="plantillas/vista1.xhtml">
            <ui:define name="content">
                <section class="container">
                    <div class="row">
                        <div class="col-sm-12" align="center">
                            <h2>Registro Ruta</h2>
                            <p:gmap id="gmap" center="19.3241874,-99.1789797" zoom="13" type="ROADMAP" style="width:500px;height:400px"
                                    model="#{registroRutaC.getModeloMapa()}" onPointClick="addLatLng(event);" widgetVar="map" />
                            <h:outputScript library="js" name="RegistroRuta.js" />


                            <h:form id="forma" styleClass="form">
                                <p:commandButton value="Borrar último punto" id="borrar-ultimo" onclick="return borrarUltimo();" />
                                <p:commandButton value="Borrar todo" id="borrar-todo" onclick="return borrarTodo();" />
                                <h:panelGrid columns="1">

                                    <input type="hidden" id="mapa" name="mapa" value="" />              

                                    <p:outputLabel for="descripcion" value="Descripción" />
                                    <p:inputTextarea id="descripcion" value="#{registroRutaC.ruta.descripcion}" rows="5" cols="33" counter="display" maxlength="120" counterTemplate="{0}" placeholder="Lista las calles por las que pasas (no tienen que ser todas, sólo avenidas importantes)"/>
                                    <h:outputText id="display" />

                                    <h:outputLabel for="lunes" value="Lunes" />
                                    <p:inputMask id="lunes" value="#{registroRutaC.horario.lunes}" mask="99:99" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>

                                    <h:outputLabel for="martes" value="Martes" />
                                    <p:inputMask id="martes" value="#{registroRutaC.horario.martes}" mask="99:99" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>

                                    <h:outputLabel for="miercoles" value="Miercoles" />
                                    <p:inputMask id="miercoles" value="#{registroRutaC.horario.miercoles}" mask="99:99" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>

                                    <h:outputLabel for="jueves" value="Jueves" />
                                    <p:inputMask id="jueves" value="#{registroRutaC.horario.jueves}" mask="99:99" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>

                                    <h:outputLabel for="viernes" value="Viernes" />
                                    <p:inputMask id="viernes" value="#{registroRutaC.horario.viernes}" mask="99:99" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>

                                    <h:outputLabel for="sabado" value="Sábado" />
                                    <p:inputMask id="sabado" value="#{registroRutaC.horario.sabado}" mask="99:99" > 
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:inputMask>
                                    <h:messages infoStyle="color:red"/>
                                </h:panelGrid>
                                <p:dialog id="dialogTest" header="Exito" widgetVar="dlg2" modal="true"  draggable="false"  
                                          resizable="false" closable="false" height="100" visible="#{registroRutaC.exito}">
                                    <p:messages />
                                    <p:button value="Cerrar" onclick="PF('dlg2').hide()" outcome="PaginaPrincipalIH"/>
                                </p:dialog>

                                <p:commandButton value="Registrar" action="#{registroRutaC.registro()}" update="dialogTest,forma" 
                                                 onclick="if (#{pasajeroC.exito}) {
                                                             PF('dlg2').show();
                                                         }" >
                                    <f:actionListener binding="#{registroRutaC.ruta.setAutomovil(sesionC.cAuto())}" />
                                </p:commandButton>
                            </h:form>
                        </div>
                    </div>
                </section>
            </ui:define>
        </ui:composition>

    </h:body>
</html>